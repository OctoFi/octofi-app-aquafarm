{"version":3,"sources":["lib/strategies/balancer/index.js","lib/strategies/contract-call/index.js","lib/strategies/erc20-balance-of/index.js","lib/strategies/erc20-balance-of-coeff/index.js","lib/strategies/erc20-balance-of-fixed-total/index.js","lib/strategies/erc20-balance-of-cv/index.js","lib/strategies/erc20-with-balance/index.js","lib/plugins/index.js","lib/strategies/erc20-balance-of-delegation/index.js","lib/strategies/eth-balance/index.js","lib/strategies/maker-ds-chief/index.js","lib/strategies/uni/index.js","lib/strategies/yearn-vault/index.js","lib/strategies/moloch/index.js","lib/strategies/uniswap/index.js","lib/strategies/pancake/index.js","lib/strategies/synthetix/index.js","lib/strategies/ctoken/index.js","lib/strategies/cream/index.js","lib/strategies/esd/index.js","lib/strategies/staked-uniswap/index.js","lib/strategies/index.js","lib/utils.js"],"names":["BALANCER_SUBGRAPH_URL","1","42","space","network","provider","addresses","options","snapshot","a","params","poolShares","__args","where","userAddress_in","map","address","toLowerCase","balance_gt","first","orderBy","orderDirection","userAddress","id","balance","poolId","totalShares","tokens","block","number","subgraphRequest","result","score","forEach","poolShare","poolToken","split","getAddress","getArgs","args","arg","replace","blockTag","multicall","methodABI","name","response","Object","fromEntries","value","i","parseFloat","formatUnits","toString","decimals","abi","constant","inputs","internalType","type","outputs","payable","stateMutability","strategy","erc20BalanceOfStrategy","entries","coeff","totalScore","values","reduce","b","total","Math","sqrt","minBalance","getDelegations","delegations","delegate_in","delegator_not_in","space_in","delegator","delegate","SNAPSHOT_SUBGRAPH_URL","delegationsReverse","delegation","filter","keys","length","console","debug","concat","MULTICALL","MAKER_DS_CHIEF_ADDRESS","UNI_ADDRESS","Promise","all","pricePerFullShare","memberAddresses","addr","shares","UNISWAP_SUBGRAPH_URL","_space","users","id_in","liquidityPositions","liquidityTokenBalance_gt","liquidityTokenBalance","pair","token0","reserve0","token1","reserve1","totalSupply","tokenAddress","u","lp","token0perUni","token1perUni","userScore","sousChefabi","masterChefAbi","masterChefContractAddress","masterBalances","chefAddresses","item","sousBalances","index","prev","cur","idx","amount","synthetixStateAbi","synthetixStateContractAddress","_","quadraticWeighting","scaledValue","initialDebtOwnership","offsetCheck","getBlockNumber","oldBlockTag","balanceOfCalls","borrowBalanceCalls","calls","balancesOldResponse","balancesNowResponse","slice","borrowsNowResponse","resultData","noBorrow","borrowingRestricted","localeCompare","balanceNow","balanceOld","min","CREAM_SWAP_SUBGRAPH_URL","3","longTermPoolABI","creamAddress","creamSwapScore","creamBalanceOf","creamBalance","userBalance","numPool","pools","numAddress","push","balances","sum","j","daoQuery","dao","lpQuery","rewards","token","uniswap","uniswapESD","uniswapTotalSupply","daoBalances","lpBalances","Array","fill","div","mul","add","tokenAbi","uniswapAddress","stakingAddress","res","tokenBalanceInUni","tokensPerUni","balancer","erc20BalanceOf","uni","moloch","pancake","synthetix","ctoken","cream","esd","4","5","6","56","82","97","100","wanchain","itf","Interface","multi","getContract","multicallAbi","aggregate","call","encodeFunctionData","decodeFunctionResult","reject","url","query","fetch","method","headers","Accept","body","JSON","stringify","jsonToGraphQLQuery","json","data","getScores","strategies","_strategies","_numeral","format","numeral","formatProposal","base","proposal","parse","msg","input","fallback","err","jsonParse","version","payload","start","end","bpt_voting_disabled","metadata","formatProposals","proposals"],"mappings":"0eAMMA,EAAwB,CAC7BC,EAAG,sEACHC,GAAI,wE,4CAGE,WAAwBC,EAAOC,EAASC,EAAUC,EAAWC,EAASC,GAAtE,mBAAAC,EAAA,6DACAC,EAAS,CACdC,WAAY,CACXC,OAAQ,CACPC,MAAO,CACNC,eAAgBR,EAAUS,KAAI,SAACC,GAAD,OAAaA,EAAQC,iBACnDC,WAAY,GAEbC,MAAO,IACPC,QAAS,UACTC,eAAgB,QAEjBC,YAAa,CACZC,IAAI,GAELC,SAAS,EACTC,OAAQ,CACPC,aAAa,EACbC,OAAQ,CACPJ,IAAI,EACJC,SAAS,MAKI,WAAbhB,IAEHE,EAAOC,WAAWC,OAAOgB,MAAQ,CAAEC,OAAQrB,IA3BtC,SA6BesB,GAAgB9B,EAAsBI,GAAUM,GA7B/D,cA6BAqB,EA7BA,OA8BAC,EAAQ,GACVD,GAAUA,EAAOpB,YACpBoB,EAAOpB,WAAWsB,SAAQ,SAACC,GAAD,OACzBA,EAAUT,OAAOE,OAAOZ,KAAI,SAACoB,GAAe,IAAD,EACjBA,EAAUZ,GAAGa,MAAM,KAC5C,GAF0C,sBAErB7B,EAAQS,QAAQC,cAAe,CACnD,IAAMK,EAAce,YAAWH,EAAUZ,YAAYC,IAChDS,EAAMV,KAAcU,EAAMV,GAAe,GAC9CU,EAAMV,GACLU,EAAMV,GAAgBa,EAAUX,QAAUU,EAAUT,OAAOC,YAAeQ,EAAUV,eAvCnF,kBA4CCQ,GAAS,IA5CV,4C,mCCLP,SAASM,EAAQ/B,EAASS,GAEzB,OADaT,EAAQgC,MAAQ,CAAC,eAClBxB,KAAI,SAACyB,GAAD,MAAyB,kBAARA,EAAmBA,EAAIC,QAAQ,cAAezB,GAAWwB,K,4CAGpF,WAAwBrC,EAAOC,EAASC,EAAUC,EAAWC,EAASC,GAAtE,iBAAAC,EAAA,6DACAiC,EAA+B,kBAAblC,EAAwBA,EAAW,SADrD,SAEiBmC,GACtBvC,EACAC,EACA,CAACE,EAAQqC,WACTtC,EAAUS,KAAI,SAACC,GAAD,MAAa,CAACT,EAAQS,QAAST,EAAQqC,UAAUC,KAAMP,EAAQ/B,EAASS,OACtF,CAAE0B,aAPG,cAEAI,EAFA,yBASCC,OAAOC,YACbF,EAAS/B,KAAI,SAACkC,EAAOC,GAAR,MAAc,CAAC5C,EAAU4C,GAAIC,WAAWC,YAAYH,EAAMI,WAAY9C,EAAQ+C,iBAVtF,4C,sBCRA,IAGDC,EAAM,CACX,CACCC,UAAU,EACVC,OAAQ,CACP,CACCC,aAAc,UACdb,KAAM,UACNc,KAAM,YAGRd,KAAM,YACNe,QAAS,CACR,CACCF,aAAc,UACdb,KAAM,GACNc,KAAM,YAGRE,SAAS,EACTC,gBAAiB,OACjBH,KAAM,aAID,SAAeI,EAAtB,4C,4CAAO,WAAwB5D,EAAOC,EAASC,EAAUC,EAAWC,EAASC,GAAtE,iBAAAC,EAAA,6DACAiC,EAA+B,kBAAblC,EAAwBA,EAAW,SADrD,SAEiBmC,GACtBvC,EACAC,EACAkD,EACAjD,EAAUS,KAAI,SAACC,GAAD,MAAa,CAACT,EAAQS,QAAS,YAAa,CAACA,OAC3D,CAAE0B,aAPG,cAEAI,EAFA,yBASCC,OAAOC,YACbF,EAAS/B,KAAI,SAACkC,EAAOC,GAAR,MAAc,CAAC5C,EAAU4C,GAAIC,WAAWC,YAAYH,EAAMI,WAAY9C,EAAQ+C,iBAVtF,4C,kECzBA,WAAwBnD,EAAOC,EAASC,EAAUC,EAAWC,EAASC,GAAtE,eAAAC,EAAA,sEACcuD,EAAuB7D,EAAOC,EAASC,EAAUC,EAAWC,EAASC,GADnF,cACAwB,EADA,yBAECe,OAAOC,YAAYD,OAAOkB,QAAQjC,GAAOjB,KAAI,SAACC,GAAD,MAAa,CAACA,EAAQ,GAAIA,EAAQ,GAAKT,EAAQ2D,YAF7F,4C,kECAA,WAAwB/D,EAAOC,EAASC,EAAUC,EAAWC,EAASC,GAAtE,iBAAAC,EAAA,sEACcuD,EAAuB7D,EAAOC,EAASC,EAAUC,EAAWC,EAASC,GADnF,cACAwB,EADA,OAEAmC,EAAapB,OAAOqB,OAAOpC,GAAOqC,QAAO,SAAC5D,EAAG6D,GAAJ,OAAU7D,EAAI6D,IAAG,GAF1D,kBAGCvB,OAAOC,YACbD,OAAOkB,QAAQjC,GAAOjB,KAAI,SAACC,GAAD,MAAa,CAACA,EAAQ,GAAKT,EAAQgE,MAAQvD,EAAQ,GAAMmD,QAJ9E,4C,kECAA,WAAwBhE,EAAOC,EAASC,EAAUC,EAAWC,EAASC,GAAtE,eAAAC,EAAA,sEACcuD,EAAuB7D,EAAOC,EAASC,EAAUC,EAAWC,EAASC,GADnF,cACAwB,EADA,yBAECe,OAAOC,YAAYD,OAAOkB,QAAQjC,GAAOjB,KAAI,SAACC,GAAD,MAAa,CAACA,EAAQ,GAAIwD,KAAKC,KAAKzD,EAAQ,UAF1F,4C,kECAA,WAAwBb,EAAOC,EAASC,EAAUC,EAAWC,EAASC,GAAtE,eAAAC,EAAA,sEACcuD,EAAuB7D,EAAOC,EAASC,EAAUC,EAAWC,EAASC,GADnF,cACAwB,EADA,yBAECe,OAAOC,YACbD,OAAOkB,QAAQjC,GAAOjB,KAAI,SAACC,GAAD,MAAa,CAACA,EAAQ,GAAIA,EAAQ,IAAMT,EAAQmE,YAAc,GAAK,EAAI,QAH5F,4C,sBCHA,SAAeC,EAAtB,4C,4CAAO,WAA8BxE,EAAOC,EAASC,EAAUC,EAAWC,EAASC,GAA5E,mBAAAC,EAAA,6DACAC,EAAS,CACdkE,YAAa,CACZhE,OAAQ,CACPC,MAAO,CACNgE,YAAavE,EAAUS,KAAI,SAACC,GAAD,OAAaA,EAAQC,iBAChD6D,iBAAkBxE,EAAUS,KAAI,SAACC,GAAD,OAAaA,EAAQC,iBACrD8D,SAAU,CAAC,GAAI5E,IAEhBgB,MAAO,KAER6D,WAAW,EACX7E,OAAO,EACP8E,UAAU,IAGK,WAAbzE,IAEHE,EAAOkE,YAAYhE,OAAOgB,MAAQ,CAAEC,OAAQrB,IAlBvC,SAoBesB,GAAgBoD,GAAsB9E,GAAUM,GApB/D,WAoBAqB,EApBA,SAqBUA,EAAO6C,YArBjB,yCAqBqC,IArBrC,cAuBAO,EAAqB,GAC3BpD,EAAO6C,YAAY3C,SAAQ,SAACmD,GAAD,OAAiBD,EAAmBC,EAAWJ,WAAaI,EAAWH,YAClGlD,EAAO6C,YACLS,QAAO,SAACD,GAAD,MAAqC,KAArBA,EAAWjF,SAClC8B,SAAQ,SAACmD,GAAD,OAAiBD,EAAmBC,EAAWJ,WAAaI,EAAWH,YA3B3E,kBA6BClC,OAAOC,YACb1C,EAAUS,KAAI,SAACC,GAAD,MAAa,CAC1BA,EACA+B,OAAOkB,QAAQkB,GACbE,QAAO,gBAAIJ,EAAJ,2BAAkBjE,EAAQC,gBAAkBgE,KACnDlE,KAAI,gDAlCF,6C,kECIA,WAAwBZ,EAAOC,EAASC,EAAUC,EAAWC,EAASC,GAAtE,iBAAAC,EAAA,sEACoBkE,EAAexE,EAAOC,EAASC,EAAUC,EAAWC,EAASC,GADjF,UACAoE,EADA,OAEkC,IAApC7B,OAAOuC,KAAKV,GAAaW,OAFvB,yCAE4C,IAF5C,cAGNC,QAAQC,MAAM,cAAeb,GAHvB,SAKcZ,EACnB7D,EACAC,EACAC,EACA0C,OAAOqB,OAAOQ,GAAaP,QAAO,SAAC5D,EAAG6D,GAAJ,OAAU7D,EAAEiF,OAAOpB,MACrD/D,EACAC,GAXK,cAKAwB,EALA,OAaNwD,QAAQC,MAAM,mBAAoBzD,GAb5B,kBAeCe,OAAOC,YACb1C,EAAUS,KAAI,SAACC,GAEd,MAAO,CAACA,EADa4D,EAAY5D,GAAW4D,EAAY5D,GAASqD,QAAO,SAAC5D,EAAG6D,GAAJ,OAAU7D,EAAIuB,EAAMsC,KAAI,GAAK,QAjBjG,6C,kECCA,WAAwBnE,EAAOC,EAASC,EAAUC,EAAWC,EAASC,GAAtE,iBAAAC,EAAA,6DACAiC,EAA+B,kBAAblC,EAAwBA,EAAW,SADrD,SAEiBmC,GACtBvC,EACAC,EACAkD,IACAjD,EAAUS,KAAI,SAACC,GAAD,MAAa,CAAC2E,GAAUvF,GAAU,gBAAiB,CAACY,OAClE,CAAE0B,aAPG,cAEAI,EAFA,yBASCC,OAAOC,YACbF,EAAS/B,KAAI,SAACkC,EAAOC,GAAR,MAAc,CAAC5C,EAAU4C,GAAIC,WAAWC,YAAYH,EAAMI,WAAY,WAV9E,4C,sBCJA,IAGDuC,EAAyB,CAC9B3F,EAAG,8CAGEsD,EAAM,CACX,CACCC,UAAU,EACVC,OAAQ,CACP,CACCZ,KAAM,GACNc,KAAM,YAGRd,KAAM,WACNe,QAAS,CACR,CACCf,KAAM,GACNc,KAAM,YAGRE,SAAS,EACTC,gBAAiB,OACjBH,KAAM,a,4CAID,WAAwBxD,EAAOC,EAASC,EAAUC,EAAWC,EAASC,GAAtE,iBAAAC,EAAA,6DACAiC,EAA+B,kBAAblC,EAAwBA,EAAW,SADrD,SAEiBmC,GACtBvC,EACAC,EACAkD,EACAjD,EAAUS,KAAI,SAACC,GAAD,MAAa,CAAC4E,EAAuBxF,GAAU,WAAY,CAACY,OAC1E,CAAE0B,aAPG,cAEAI,EAFA,yBASCC,OAAOC,YACbF,EAAS/B,KAAI,SAACkC,EAAOC,GAAR,MAAc,CAAC5C,EAAU4C,GAAIC,WAAWC,YAAYH,EAAMI,WAAY9C,EAAQ+C,iBAVtF,4C,sBC7BA,IAGDuC,EAAc,CACnB5F,EAAG,8CAGEsD,EAAM,CACX,CACCC,UAAU,EACVC,OAAQ,CACP,CACCC,aAAc,UACdb,KAAM,UACNc,KAAM,YAGRd,KAAM,kBACNe,QAAS,CACR,CACCF,aAAc,SACdb,KAAM,GACNc,KAAM,WAGRE,SAAS,EACTC,gBAAiB,OACjBH,KAAM,a,4CAID,WAAwBxD,EAAOC,EAASC,EAAUC,EAAWC,EAASC,GAAtE,iBAAAC,EAAA,6DACAiC,EAA+B,kBAAblC,EAAwBA,EAAW,SADrD,SAEiBmC,GACtBvC,EACAC,EACAkD,EACAjD,EAAUS,KAAI,SAACC,GAAD,MAAa,CAAC6E,EAAYzF,GAAU,kBAAmB,CAACY,EAAQC,eAAgB,CAAEyB,iBAN3F,cAEAI,EAFA,yBAQCC,OAAOC,YACbF,EAAS/B,KAAI,SAACkC,EAAOC,GAAR,MAAc,CAAC5C,EAAU4C,GAAIC,WAAWC,YAAYH,EAAMI,WAAY9C,EAAQ+C,iBATtF,4C,sBC9BA,IAGDC,EAAM,CACX,CACCC,UAAU,EACVC,OAAQ,GACRZ,KAAM,uBACNe,QAAS,CACR,CACCF,aAAc,UACdb,KAAM,GACNc,KAAM,YAGRE,SAAS,EACTC,gBAAiB,OACjBH,KAAM,a,4CAID,WAAwBxD,EAAOC,EAASC,EAAUC,EAAWC,EAASC,GAAtE,yBAAAC,EAAA,6DACAiC,EAA+B,kBAAblC,EAAwBA,EAAW,SADrD,SAEmCsF,QAAQC,IAAI,CACpD/B,EAAuB7D,EAAOC,EAASC,EAAUC,EAAWC,EAASC,GACrEmC,GAAUvC,EAASC,EAAUkD,EAAK,CAAC,CAAChD,EAAQS,QAAS,uBAAwB,KAAM,CAAE0B,eAJhF,0CAEDV,EAFC,2BAEOgE,EAFP,KAMNA,EAAoB7C,WAAWC,YAAY4C,EAAkB3C,WAAY,KANnE,kBAOCN,OAAOC,YAAYD,OAAOkB,QAAQjC,GAAOjB,KAAI,SAACC,GAAD,MAAa,CAACA,EAAQ,GAAIA,EAAQ,GAAKgF,QAPrF,6C,sBCtBA,IAGDzC,EAAM,CACX,CACCE,OAAQ,CACP,CACCC,aAAc,UACdb,KAAM,GACNc,KAAM,YAGRd,KAAM,6BACNe,QAAS,CACR,CACCF,aAAc,UACdb,KAAM,GACNc,KAAM,YAGRG,gBAAiB,OACjBH,KAAM,YAEP,CACCF,OAAQ,CACP,CACCC,aAAc,UACdb,KAAM,GACNc,KAAM,YAGRd,KAAM,UACNe,QAAS,CACR,CACCF,aAAc,UACdb,KAAM,cACNc,KAAM,WAEP,CACCD,aAAc,UACdb,KAAM,SACNc,KAAM,WAEP,CACCD,aAAc,UACdb,KAAM,OACNc,KAAM,WAEP,CACCD,aAAc,OACdb,KAAM,SACNc,KAAM,QAEP,CACCD,aAAc,UACdb,KAAM,sBACNc,KAAM,WAEP,CACCD,aAAc,UACdb,KAAM,SACNc,KAAM,YAGRG,gBAAiB,OACjBH,KAAM,YAEP,CACCF,OAAQ,GACRZ,KAAM,cACNe,QAAS,CACR,CACCF,aAAc,UACdb,KAAM,GACNc,KAAM,YAGRG,gBAAiB,OACjBH,KAAM,a,4CAID,WAAwBxD,EAAOC,EAASC,EAAUC,EAAWC,EAASC,GAAtE,mBAAAC,EAAA,6DACAiC,EAA+B,kBAAblC,EAAwBA,EAAW,SADrD,SAEwBmC,GAC7BvC,EACAC,EACAkD,EACAjD,EAAUS,KAAI,SAACC,GAAD,MAAa,CAACT,EAAQS,QAAS,6BAA8B,CAACA,OAC5E,CAAE0B,aAPG,cAEAuD,EAFA,gBAUiBtD,GACtBvC,EACAC,EACAkD,EACA0C,EACEZ,QAAO,SAACa,GAAD,MAA8B,+CAApBA,EAAK7C,cACtBtC,KAAI,SAACmF,GAAD,MAAU,CAAC3F,EAAQS,QAAS,UAAW,CAACkF,EAAK7C,gBACnD,CAAEX,aAjBG,cAUAI,EAVA,yBAoBCC,OAAOC,YACbF,EAAS/B,KAAI,SAACkC,EAAOC,GAAR,MAAc,CAAC5C,EAAU4C,GAAIC,WAAWC,YAAYH,EAAMkD,OAAO9C,WAAY9C,EAAQ+C,iBArB7F,4C,sBClFP,IAAM8C,EAAuB,CAC5BnG,EAAG,8D,4CAMG,WAAwBoG,EAAQjG,EAASC,EAAUC,EAAWC,EAASC,GAAvE,qBAAAC,EAAA,6DACAC,EAAS,CACd4F,MAAO,CACN1F,OAAQ,CACPC,MAAO,CACN0F,MAAOjG,EAAUS,KAAI,SAACC,GAAD,OAAaA,EAAQC,kBAE3CE,MAAO,KAERI,IAAI,EACJiF,mBAAoB,CACnB5F,OAAQ,CACPC,MAAO,CACN4F,yBAA0B,IAG5BC,uBAAuB,EACvBC,KAAM,CACLpF,IAAI,EACJqF,OAAQ,CACPrF,IAAI,GAELsF,UAAU,EACVC,OAAQ,CACPvF,IAAI,GAELwF,UAAU,EACVC,aAAa,MAKA,WAAbxG,IAEHE,EAAO4F,MAAME,mBAAmB5F,OAAOgB,MAAQ,CAAEC,OAAQrB,IAEpDyG,EAAe1G,EAAQS,QAAQC,cApC/B,SAqCea,GAAgBsE,EAAqBhG,GAAUM,GArC9D,cAqCAqB,EArCA,OAsCAC,EAAQ,GACVD,GAAUA,EAAOuE,OACpBvE,EAAOuE,MAAMrE,SAAQ,SAACiF,GACrBA,EAAEV,mBACAnB,QAAO,SAAC8B,GAAD,OAAQA,EAAGR,KAAKC,OAAOrF,IAAM0F,GAAgBE,EAAGR,KAAKG,OAAOvF,IAAM0F,KACzEhF,SAAQ,SAACkF,GACT,IAAMC,EAAeD,EAAGR,KAAKE,SAAWM,EAAGR,KAAKK,YAC1CK,EAAeF,EAAGR,KAAKI,SAAWI,EAAGR,KAAKK,YAC1CM,EACLH,EAAGR,KAAKC,OAAOrF,IAAM0F,EAClBG,EAAeD,EAAGT,sBAClBW,EAAeF,EAAGT,sBAEhBpF,EAAce,YAAW6E,EAAE3F,IAC5BS,EAAMV,KAAcU,EAAMV,GAAe,GAC9CU,EAAMV,GAAeU,EAAMV,GAAegG,QArDxC,kBAyDCtF,GAAS,IAzDV,4C,sBCNA,IAGDuF,EAAc,CACnB,CACC9D,OAAQ,CACP,CACCC,aAAc,UACdb,KAAM,GACNc,KAAM,YAGRd,KAAM,WACNe,QAAS,CACR,CACCF,aAAc,UACdb,KAAM,SACNc,KAAM,YAGRG,gBAAiB,OACjBH,KAAM,aAIF6D,EAAgB,CACrB,CACC/D,OAAQ,CACP,CACCC,aAAc,UACdb,KAAM,GACNc,KAAM,WAEP,CACCD,aAAc,UACdb,KAAM,GACNc,KAAM,YAGRd,KAAM,WACNe,QAAS,CACR,CACCF,aAAc,UACdb,KAAM,SACNc,KAAM,WAEP,CACCD,aAAc,UACdb,KAAM,aACNc,KAAM,YAGRG,gBAAiB,OACjBH,KAAM,aAIF8D,EAA4B,6C,4CAE3B,WAAwBtH,EAAOC,EAASC,EAAUC,EAAWC,EAASC,GAAtE,qBAAAC,EAAA,6DACAiC,EAA+B,kBAAblC,EAAwBA,EAAW,SADrD,SAEcwD,EAAuB7D,EAAOC,EAASC,EAAUC,EAAWC,EAASC,GAFnF,cAEAwB,EAFA,gBAIuBW,GAC5BvC,EACAC,EACAmH,EACAlH,EAAUS,KAAI,SAACC,GAAD,MAAa,CAACyG,EAA2B,WAAY,CAAC,IAAKzG,OACzE,CAAE0B,aATG,cAIAgF,EAJA,gBAYqB5B,QAAQC,IAClCxF,EAAQoH,cAAc5G,KAAI,SAAC6G,GAAD,OACzBjF,GACCvC,EACAC,EACAkH,EACAjH,EAAUS,KAAI,SAACC,GAAD,MAAa,CAAC4G,EAAK5G,QAAS,WAAY,CAACA,GAAU,CAAE0B,gBACnE,CAAEA,iBAnBC,cAYAmF,EAZA,yBAwBC9E,OAAOC,YACbD,OAAOkB,QAAQjC,GAAOjB,KAAI,SAACC,EAAS8G,GAAV,MAAoB,CAC7C9G,EAAQ,GACRA,EAAQ,GACP0G,EAAerD,QACd,SAAC0D,EAAMC,EAAKC,GAAZ,OAAoBF,EAAO5E,WAAWC,YAAY4E,EAAIE,OAAO7E,WAAY,OACzE,GAEDwE,EAAaxD,QACZ,SAAC0D,EAAMC,EAAKC,GAAZ,OACCF,EACA5E,WAAWC,YAAY4E,EAAIF,GAAOI,OAAO7E,WAAY9C,EAAQoH,cAAcM,GAAK3E,aACjF,SApCE,6C,sBC5DA,IAGD6E,EAAoB,CACzB,CACC3E,UAAU,EACVC,OAAQ,CAAC,CAAEZ,KAAM,GAAIc,KAAM,YAC3Bd,KAAM,eACNe,QAAS,CACR,CAAEf,KAAM,uBAAwBc,KAAM,WACtC,CAAEd,KAAM,iBAAkBc,KAAM,YAEjCE,SAAS,EACTC,gBAAiB,OACjBH,KAAM,aAIFyE,EAAgC,6C,4CAE/B,WAAwBjI,EAAOC,EAASC,EAAUC,EAAW+H,EAAG7H,GAAhE,mBAAAC,EAAA,6DACAiC,EAA+B,kBAAblC,EAAwBA,EAAW,SADrD,SAEiBmC,GACtBvC,EACAC,EACA8H,EACA7H,EAAUS,KAAI,SAACC,GAAD,MAAa,CAACoH,EAA+B,eAAgB,CAACpH,OAC5E,CAAE0B,aAPG,cAEAI,EAFA,OAUAwF,EAAqB,SAACrF,GAE3B,IAAMsF,EAAsB,IAARtF,EACpB,OAAOuB,KAAKC,KAAK8D,IAbZ,kBAeCxF,OAAOC,YACbF,EAAS/B,KAAI,SAACkC,EAAOC,GACpB,MAAO,CACN5C,EAAU4C,GAEVoF,EAAmBnF,WAAWC,YAAYH,EAAMuF,qBAAqBnF,WAAY,YApB9E,4C,sBCpBA,IAGDE,EAAM,CACX,CACCC,UAAU,EACVC,OAAQ,CACP,CACCC,aAAc,UACdb,KAAM,UACNc,KAAM,YAGRd,KAAM,YACNe,QAAS,CACR,CACCF,aAAc,UACdb,KAAM,GACNc,KAAM,YAGRE,SAAS,EACTC,gBAAiB,OACjBH,KAAM,YAEP,CACCH,UAAU,EACVC,OAAQ,CACP,CACCC,aAAc,UACdb,KAAM,UACNc,KAAM,YAGRd,KAAM,sBACNe,QAAS,CACR,CACCF,aAAc,UACdb,KAAM,GACNc,KAAM,YAGRE,SAAS,EACTC,gBAAiB,OACjBH,KAAM,a,4CAID,WAAwBxD,EAAOC,EAASC,EAAUC,EAAWC,EAASC,GAAtE,6CAAAC,EAAA,yDACAiC,EAA+B,kBAAblC,EAAwBA,EAAW,SAEtC,kBAAbA,EAHF,qBAIFA,EAAWD,EAAQkI,YAJjB,uCAKKpI,EAASqI,iBALd,wBAKkCnI,EAAQkI,YAL1C,8BAEAE,EAFA,KAOFC,EAAiBtI,EAAUS,KAAI,SAACC,GAAD,MAAa,CAACT,EAAQS,QAAS,YAAa,CAACA,OAC5E6H,EAAqBvI,EAAUS,KAAI,SAACC,GAAD,MAAa,CAACT,EAAQS,QAAS,sBAAuB,CAACA,OAC1F8H,EAAQF,EAAelD,OAAOmD,GAT5B,UAWwC/C,QAAQC,IAAI,CACzDpD,GAAUvC,EAASC,EAAUkD,EAAKuF,EAAO,CAAEpG,aAC3CC,GACCvC,EACAC,EACAkD,EACAjD,EAAUS,KAAI,SAACC,GAAD,MAAa,CAACT,EAAQS,QAAS,YAAa,CAACA,OAC3D,CAAE0B,SAAUiG,MAlBR,QA0BN,IA1BM,4BAWC7F,EAXD,KAWWiG,EAXX,KAsBAC,EAAsBlG,EAASmG,MAAM,EAAG3I,EAAUiF,QAClD2D,EAAqBpG,EAASmG,MAAM3I,EAAUiF,QAEhD4D,EAAa,GACRjG,EAAI,EAAGA,EAAI8F,EAAoBzD,OAAQrC,IAC3CkG,EAAW,EACX7I,EAAQ8I,sBACXD,EAAkE,GAAvDF,EAAmBhG,GAAGG,WAAWiG,cAAc,KAAY,EAAI,GAErEC,EAAapG,WAAWC,YAAY4F,EAAoB9F,GAAGG,WAAY9C,EAAQ+C,WAC/EkG,EAAarG,WAAWC,YAAY2F,EAAoB7F,GAAGG,WAAY9C,EAAQ+C,WACrF6F,EAAW7I,EAAU4C,IAAMsB,KAAKiF,IAAIF,EAAYC,GAAcJ,EAjCzD,yBAmCCD,GAnCD,6C,sBC/CA,IAGDO,EAA0B,CAC/BzJ,EAAG,wEACH0J,EAAG,0EAGEC,EAAkB,CACvB,CACCpG,UAAU,EACVC,OAAQ,CACP,CACCC,aAAc,UACdb,KAAM,UACNc,KAAM,YAGRd,KAAM,YACNe,QAAS,CACR,CACCF,aAAc,UACdb,KAAM,GACNc,KAAM,YAGRE,SAAS,EACTC,gBAAiB,OACjBH,KAAM,a,4CAID,WAAwBxD,EAAOC,EAASC,EAAUC,EAAWC,EAASC,GAAtE,iCAAAC,EAAA,6DACAoJ,EAAetJ,EAAQS,QADvB,SAE4B8E,QAAQC,IAAI,CAC7C+D,GAAe1J,EAASE,EAAWuJ,EAAcrJ,GACjDuJ,GAAe3J,EAASC,EAAUC,EAAWC,EAASC,KAJjD,OAMN,IANM,4BAEDwB,EAFC,KAEMgI,EAFN,KAMN,MAAyCjH,OAAOkB,QAAQ+F,GAAxD,eAAwE,EAAD,oBAA3D1I,EAA2D,KAA9C2I,EAA8C,KACjEjI,EAAMV,KAAcU,EAAMV,GAAe,GAC9CU,EAAMV,GAAeU,EAAMV,GAAe2I,EARrC,yBAWCjI,GAAS,IAXV,4C,+BAcQ8H,G,uFAAf,WAA8B1J,EAASE,EAAWuJ,EAAcrJ,GAAhE,mBAAAC,EAAA,6DACOC,EAAS,CACdC,WAAY,CACXC,OAAQ,CACPC,MAAO,CACNC,eAAgBR,EAAUS,KAAI,SAACC,GAAD,OAAaA,EAAQC,iBACnDC,WAAY,GAEbC,MAAO,IACPC,QAAS,UACTC,eAAgB,QAEjBC,YAAa,CACZC,IAAI,GAELC,SAAS,EACTC,OAAQ,CACPC,aAAa,EACbC,OAAQ,CACPJ,IAAI,EACJC,SAAS,MAKI,WAAbhB,IAEHE,EAAOC,WAAWC,OAAOgB,MAAQ,CAAEC,OAAQrB,IA3B7C,SA6BsBsB,GAAgB4H,EAAwBtJ,GAAUM,GA7BxE,cA6BOqB,EA7BP,OA8BOC,EAAQ,GACVD,GAAUA,EAAOpB,YACpBoB,EAAOpB,WAAWsB,SAAQ,SAACC,GAAD,OACzBA,EAAUT,OAAOE,OAAOZ,KAAI,SAACoB,GAAe,IAAD,EACjBA,EAAUZ,GAAGa,MAAM,KAAnC6E,EADiC,oBAE1C,GAA4B,kBAAjB4C,GAA6B5C,IAAiB4C,EAAa5I,cAAe,CACpF,IAAMK,EAAce,YAAWH,EAAUZ,YAAYC,IAChDS,EAAMV,KAAcU,EAAMV,GAAe,GAC9CU,EAAMV,GACLU,EAAMV,GAAgBa,EAAUX,QAAUU,EAAUT,OAAOC,YAAeQ,EAAUV,eAvC1F,kBA4CQQ,GAAS,IA5CjB,4C,+BA+Ce+H,G,yFAAf,WAA8B3J,EAASC,EAAUC,EAAWC,EAASC,GAArE,2BAAAC,EAAA,sDAMC,IALMiC,EAA+B,kBAAblC,EAAwBA,EAAW,SACrD0J,EAAU3J,EAAQ4J,MAAM5E,OACxB6E,EAAa9J,EAAUiF,OAEvBuD,EAAQ,GALf,WAMU5F,GACR4F,EAAMuB,KAAN,MAAAvB,EAAK,YAASxI,EAAUS,KAAI,SAACC,GAAD,MAAa,CAACT,EAAQ4J,MAAMjH,GAAGlC,QAAS,YAAa,CAACA,UAD1EkC,EAAI,EAAGA,EAAIgH,EAAShH,IAAM,EAA1BA,GANV,gBAUwBP,GAAUvC,EAASC,EAAUuJ,EAAiBd,EAAO,CAC3EpG,aAXF,cAUO4H,EAVP,yBAcQvH,OAAOC,YACb1C,EAAUS,KAAI,SAACC,EAASkC,GAEvB,IADA,IAAIqH,EAAM,EACDC,EAAI,EAAGA,EAAIN,EAASM,IAC5BD,GAAOpH,WAAWC,YAAYkH,EAASpH,EAAIsH,EAAIJ,GAAY/G,WAAY,KAExE,MAAO,CAACrC,EAASuJ,QApBpB,6C,sBC9FO,IAGDhH,GAAM,CACX,CACCC,UAAU,EACVC,OAAQ,CAAC,CAAEC,aAAc,UAAWb,KAAM,UAAWc,KAAM,YAC3Dd,KAAM,kBACNe,QAAS,CAAC,CAAEF,aAAc,UAAWb,KAAM,GAAIc,KAAM,YACrDE,SAAS,EACTC,gBAAiB,OACjBH,KAAM,YAEP,CACCH,UAAU,EACVC,OAAQ,CAAC,CAAEC,aAAc,UAAWb,KAAM,GAAIc,KAAM,YACpDd,KAAM,YACNe,QAAS,CAAC,CAAEF,aAAc,UAAWb,KAAM,GAAIc,KAAM,YACrDE,SAAS,EACTC,gBAAiB,OACjBH,KAAM,YAEP,CACCH,UAAU,EACVC,OAAQ,GACRZ,KAAM,cACNe,QAAS,CAAC,CAAEF,aAAc,UAAWb,KAAM,GAAIc,KAAM,YACrDE,SAAS,EACTC,gBAAiB,OACjBH,KAAM,a,8CAID,WAAwBxD,EAAOC,EAASC,EAAUC,EAAWC,EAASC,GAAtE,6BAAAC,EAAA,6DACAiC,EAA+B,kBAAblC,EAAwBA,EAAW,SAErDiK,EAAWnK,EAAUS,KAAI,SAACC,GAAD,MAAa,CAACT,EAAQmK,IAAK,kBAAmB,CAAC1J,OAExE2J,EAAUrK,EAAUS,KAAI,SAACC,GAAD,MAAa,CAACT,EAAQqK,QAAS,kBAAmB,CAAC5J,OAL3E,SAOiB2B,GACtBvC,EACAC,EACAkD,GAH+B,CAI9B,CAAChD,EAAQsK,MAAO,YAAa,CAACtK,EAAQuK,UAAW,CAACvK,EAAQuK,QAAS,gBAJrC,mBAIwDL,GAJxD,YAIqEE,IACpG,CAAEjI,aAZG,cAOAI,EAPA,OAeAiI,EAAajI,EAAS,GACtBkI,EAAqBlI,EAAS,GAC9BmI,EAAcnI,EAASmG,MAAM,EAAG3I,EAAUiF,OAAS,GACnD2F,EAAapI,EAASmG,MAAM3I,EAAUiF,OAAS,EAAsB,EAAnBjF,EAAUiF,OAAa,GAlBzE,kBAoBCxC,OAAOC,YACbmI,MAAM7K,EAAUiF,QACd6F,KAAK,KACLrK,KAAI,SAACsH,EAAGnF,GAAJ,MAAU,CACd5C,EAAU4C,GACVC,WACCC,YACC2H,EAAW,GACTM,IAAIL,EAAmB,IACvBM,IAAIJ,EAAWhI,GAAG,IAClBqI,IAAIN,EAAY/H,GAAG,IACnBG,WACF9C,EAAQ+C,iBAhCP,6C,sBClCA,IAGDkI,GAAW,CAChB,CACChI,UAAU,EACVC,OAAQ,CACP,CACCC,aAAc,UACdb,KAAM,UACNc,KAAM,YAGRd,KAAM,YACNe,QAAS,CACR,CACCF,aAAc,UACdb,KAAM,GACNc,KAAM,YAGRE,SAAS,EACTC,gBAAiB,OACjBH,KAAM,YAEP,CACCH,UAAU,EACVC,OAAQ,GACRZ,KAAM,cACNe,QAAS,CACR,CACCF,aAAc,UACdb,KAAM,GACNc,KAAM,YAGRE,SAAS,EACTC,gBAAiB,OACjBH,KAAM,a,8CAID,WAAwB0C,EAAQjG,EAASC,EAAUC,EAAWC,EAASC,GAAvE,yBAAAC,EAAA,6DACAiC,EAA+B,kBAAblC,EAAwBA,EAAW,SADrD,SAEYmC,GACjBvC,EACAC,EACAmL,GACA,CACC,CAACjL,EAAQkL,eAAgB,cAAe,IACxC,CAAClL,EAAQ0G,aAAc,YAAa,CAAC1G,EAAQkL,kBAC5C/F,OAAOpF,EAAUS,KAAI,SAACC,GAAD,MAAa,CAACT,EAAQmL,eAAgB,YAAa,CAAC1K,QAC3E,CAAE0B,aAVG,cAEAiJ,EAFA,OAaA3E,EAAc2E,EAAI,GAClBC,EAAoBD,EAAI,GACxBE,EAAeD,EAAiB,SAAG,GAAMrL,EAAQ+C,WAAY0D,EAAc,MAE3ElE,EAAW6I,EAAI1C,MAAM,GAjBrB,kBAmBClG,OAAOC,YACbF,EAAS/B,KAAI,SAACkC,EAAOC,GAAR,MAAc,CAAC5C,EAAU4C,GAAKD,EAAK,SAAG,GAAM1C,EAAQ+C,UAAYuI,QApBxE,4C,sBCvBQ,QACdC,SrBXM,SAAP,6CqBYC,gBpBZM,SAAP,6CoBaC,mBAAoBC,EACpB,+BjBpBM,SAAP,6CiBqBC,sBhBrBM,SAAP,6CgBsBC,yBlBtBM,SAAP,6CkBuBC,qBfvBM,SAAP,6CewBC,8BbvBM,SAAP,6CawBC,cZvBM,SAAP,6CYwBC,iBXCM,SAAP,6CWACC,IVEM,SAAP,6CUDC,cTRM,SAAP,6CSSCC,ORmDM,SAAP,6CQlDCnB,QPzBM,SAAP,6CO0BCoB,QN2BM,SAAP,6CM1BCC,ULdM,SAAP,6CKeCC,OJaM,SAAP,6CIZCC,MHHM,SAAP,6CGIC,iBDIM,SAAP,8CCHCC,IFLM,SAAP,+C,SG5Ba3G,GAAY,CACxB1F,EAAG,6CACHsM,EAAG,6CACHC,EAAG,6CACHC,EAAG,6CACHvM,GAAI,6CACJwM,GAAI,6CACJC,GAAI,6CACJC,GAAI,6CACJC,IAAK,6CACLC,SAAU,8CAGE5H,GAAwB,CACpCjF,EAAG,iEACHsM,EAAG,yEACHrM,GAAI,wEAaE,SAAeyC,GAAtB,2C,8CAAO,WAAyBvC,EAASC,EAAUkD,EAAKuF,EAAOvI,GAAxD,uBAAAE,EAAA,6DACAsM,EAAM,IAAIC,IAAUzJ,GACpB0J,EAAQC,aAAYvH,GAAUvF,GAAU+M,IAAc9M,GAFtD,2BAKkB4M,EAAMG,UAC3BtE,EAAM/H,KAAI,SAACsM,GAAD,MAAU,CAACA,EAAK,GAAGpM,cAAe8L,EAAIO,mBAAmBD,EAAK,GAAIA,EAAK,QACjF9M,GAAW,IAPR,0CAKKoL,EALL,uBASGA,EAAI5K,KAAI,SAACsM,EAAMnK,GAAP,OAAa6J,EAAIQ,qBAAqBzE,EAAM5F,GAAG,GAAImK,OAT9D,2DAWG,IAXH,mFAcEvH,QAAQ0H,OAAR,OAdF,kE,sBAkBA,SAAe1L,GAAtB,qC,8CAAO,WAA+B2L,EAAKC,GAApC,mBAAAjN,EAAA,sEACYkN,MAAMF,EAAK,CAC5BG,OAAQ,OACRC,QAAS,CACRC,OAAQ,mBACR,eAAgB,oBAEjBC,KAAMC,KAAKC,UAAU,CAAEP,MAAOQ,6BAAmB,CAAER,cAP9C,cACA/B,EADA,gBASiBA,EAAIwC,OATrB,uBASEC,EATF,EASEA,KATF,kBAUCA,GAAQ,IAVT,4C,sBAkBA,SAAeC,GAAtB,2C,8CAAO,WAAyBlO,EAAOmO,EAAYlO,EAASC,EAAUC,GAA/D,2BAAAG,EAAA,6DAA0ED,EAA1E,+BAAqF,SAArF,SACOsF,QAAQC,IACpBuI,EAAWvN,KAAI,SAACgD,GAAD,OACdwK,GAAYxK,EAASlB,MAAM1C,EAAOC,EAASC,EAAUC,EAAWyD,EAASrD,OAAQF,OAH7E,oF,sBAmBA,SAASgO,GAAS3M,GAA+B,IAAvB4M,EAAsB,uDAAb,YACzC,OAAOC,IAAQ7M,GAAQ4M,OAAOA,GAGxB,SAASE,GAAeC,GAC9B,IAAMC,EAAWb,KAAKc,MAAMd,KAAKC,UAAUW,IAgB3C,OAfAC,EAASE,IAjBH,SAAmBC,EAAOC,GAChC,GAAqB,kBAAVD,EACV,OAAOC,GAAY,GAEpB,IACC,OAAOjB,KAAKc,MAAME,GACjB,MAAOE,GACR,OAAOD,GAAY,IAULE,CAAUN,EAASE,IAAKF,EAASE,KAGnB,UAAzBF,EAASE,IAAIK,UAChBP,EAASE,IAAIM,QAAQC,MAAQ,UAC7BT,EAASE,IAAIM,QAAQE,IAAM,WAC3BV,EAASE,IAAIM,QAAQ7O,SAAW,SAChCqO,EAASW,oBAAsB,KAIH,UAAzBX,EAASE,IAAIK,SAAgD,UAAzBP,EAASE,IAAIK,UACpDP,EAASE,IAAIM,QAAQI,SAAW,IAG1BZ,EAGD,SAASa,GAAgBC,GAC/B,OAAO5M,OAAOC,YAAYD,OAAOkB,QAAQ0L,GAAW5O,KAAI,SAAC8N,GAAD,MAAc,CAACA,EAAS,GAAIF,GAAeE,EAAS,W","file":"static/js/9.39a7d174.chunk.js","sourcesContent":["import { getAddress } from \"@ethersproject/address\";\nimport { subgraphRequest } from \"../../utils\";\n\nexport const author = \"bonustrack\";\nexport const version = \"0.1.0\";\n\nconst BALANCER_SUBGRAPH_URL = {\n\t1: \"https://api.thegraph.com/subgraphs/name/balancer-labs/balancer-beta\",\n\t42: \"https://api.thegraph.com/subgraphs/name/balancer-labs/balancer-kovan\",\n};\n\nexport async function strategy(space, network, provider, addresses, options, snapshot) {\n\tconst params = {\n\t\tpoolShares: {\n\t\t\t__args: {\n\t\t\t\twhere: {\n\t\t\t\t\tuserAddress_in: addresses.map((address) => address.toLowerCase()),\n\t\t\t\t\tbalance_gt: 0,\n\t\t\t\t},\n\t\t\t\tfirst: 1000,\n\t\t\t\torderBy: \"balance\",\n\t\t\t\torderDirection: \"desc\",\n\t\t\t},\n\t\t\tuserAddress: {\n\t\t\t\tid: true,\n\t\t\t},\n\t\t\tbalance: true,\n\t\t\tpoolId: {\n\t\t\t\ttotalShares: true,\n\t\t\t\ttokens: {\n\t\t\t\t\tid: true,\n\t\t\t\t\tbalance: true,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t};\n\tif (snapshot !== \"latest\") {\n\t\t// @ts-ignore\n\t\tparams.poolShares.__args.block = { number: snapshot };\n\t}\n\tconst result = await subgraphRequest(BALANCER_SUBGRAPH_URL[network], params);\n\tconst score = {};\n\tif (result && result.poolShares) {\n\t\tresult.poolShares.forEach((poolShare) =>\n\t\t\tpoolShare.poolId.tokens.map((poolToken) => {\n\t\t\t\tconst [, tokenAddress] = poolToken.id.split(\"-\");\n\t\t\t\tif (tokenAddress === options.address.toLowerCase()) {\n\t\t\t\t\tconst userAddress = getAddress(poolShare.userAddress.id);\n\t\t\t\t\tif (!score[userAddress]) score[userAddress] = 0;\n\t\t\t\t\tscore[userAddress] =\n\t\t\t\t\t\tscore[userAddress] + (poolToken.balance / poolShare.poolId.totalShares) * poolShare.balance;\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t}\n\treturn score || {};\n}\n","import { formatUnits } from \"@ethersproject/units\";\nimport { multicall } from \"../../utils\";\n\nexport const author = \"in19farkt\";\nexport const version = \"0.1.0\";\n\nfunction getArgs(options, address) {\n\tconst args = options.args || [\"%{address}\"];\n\treturn args.map((arg) => (typeof arg === \"string\" ? arg.replace(/%{address}/g, address) : arg));\n}\n\nexport async function strategy(space, network, provider, addresses, options, snapshot) {\n\tconst blockTag = typeof snapshot === \"number\" ? snapshot : \"latest\";\n\tconst response = await multicall(\n\t\tnetwork,\n\t\tprovider,\n\t\t[options.methodABI],\n\t\taddresses.map((address) => [options.address, options.methodABI.name, getArgs(options, address)]),\n\t\t{ blockTag }\n\t);\n\treturn Object.fromEntries(\n\t\tresponse.map((value, i) => [addresses[i], parseFloat(formatUnits(value.toString(), options.decimals))])\n\t);\n}\n","import { formatUnits } from \"@ethersproject/units\";\nimport { multicall } from \"../../utils\";\n\nexport const author = \"bonustrack\";\nexport const version = \"0.1.0\";\n\nconst abi = [\n\t{\n\t\tconstant: true,\n\t\tinputs: [\n\t\t\t{\n\t\t\t\tinternalType: \"address\",\n\t\t\t\tname: \"account\",\n\t\t\t\ttype: \"address\",\n\t\t\t},\n\t\t],\n\t\tname: \"balanceOf\",\n\t\toutputs: [\n\t\t\t{\n\t\t\t\tinternalType: \"uint256\",\n\t\t\t\tname: \"\",\n\t\t\t\ttype: \"uint256\",\n\t\t\t},\n\t\t],\n\t\tpayable: false,\n\t\tstateMutability: \"view\",\n\t\ttype: \"function\",\n\t},\n];\n\nexport async function strategy(space, network, provider, addresses, options, snapshot) {\n\tconst blockTag = typeof snapshot === \"number\" ? snapshot : \"latest\";\n\tconst response = await multicall(\n\t\tnetwork,\n\t\tprovider,\n\t\tabi,\n\t\taddresses.map((address) => [options.address, \"balanceOf\", [address]]),\n\t\t{ blockTag }\n\t);\n\treturn Object.fromEntries(\n\t\tresponse.map((value, i) => [addresses[i], parseFloat(formatUnits(value.toString(), options.decimals))])\n\t);\n}\n","import { strategy as erc20BalanceOfStrategy } from \"../erc20-balance-of/index\";\n\nexport const author = \"jxde\";\nexport const version = \"0.1.0\";\n\nexport async function strategy(space, network, provider, addresses, options, snapshot) {\n\tconst score = await erc20BalanceOfStrategy(space, network, provider, addresses, options, snapshot);\n\treturn Object.fromEntries(Object.entries(score).map((address) => [address[0], address[1] * options.coeff]));\n}\n","import { strategy as erc20BalanceOfStrategy } from \"../erc20-balance-of/index\";\n\nexport const author = \"bonustrack\";\nexport const version = \"0.1.0\";\n\nexport async function strategy(space, network, provider, addresses, options, snapshot) {\n\tconst score = await erc20BalanceOfStrategy(space, network, provider, addresses, options, snapshot);\n\tconst totalScore = Object.values(score).reduce((a, b) => a + b, 0);\n\treturn Object.fromEntries(\n\t\tObject.entries(score).map((address) => [address[0], (options.total * address[1]) / totalScore])\n\t);\n}\n","import { strategy as erc20BalanceOfStrategy } from \"../erc20-balance-of/index\";\n\nexport const author = \"bonustrack\";\nexport const version = \"0.1.0\";\n\nexport async function strategy(space, network, provider, addresses, options, snapshot) {\n\tconst score = await erc20BalanceOfStrategy(space, network, provider, addresses, options, snapshot);\n\treturn Object.fromEntries(Object.entries(score).map((address) => [address[0], Math.sqrt(address[1])]));\n}\n","import { strategy as erc20BalanceOfStrategy } from \"../erc20-balance-of/index\";\n\nexport const author = \"BenjaminLu\";\nexport const version = \"0.1.1\";\n\nexport async function strategy(space, network, provider, addresses, options, snapshot) {\n\tconst score = await erc20BalanceOfStrategy(space, network, provider, addresses, options, snapshot);\n\treturn Object.fromEntries(\n\t\tObject.entries(score).map((address) => [address[0], address[1] > (options.minBalance || 0) ? 1 : 0])\n\t);\n}\n","import { SNAPSHOT_SUBGRAPH_URL, subgraphRequest } from \"../utils\";\n\nexport async function getDelegations(space, network, provider, addresses, options, snapshot) {\n\tconst params = {\n\t\tdelegations: {\n\t\t\t__args: {\n\t\t\t\twhere: {\n\t\t\t\t\tdelegate_in: addresses.map((address) => address.toLowerCase()),\n\t\t\t\t\tdelegator_not_in: addresses.map((address) => address.toLowerCase()),\n\t\t\t\t\tspace_in: [\"\", space],\n\t\t\t\t},\n\t\t\t\tfirst: 1000,\n\t\t\t},\n\t\t\tdelegator: true,\n\t\t\tspace: true,\n\t\t\tdelegate: true,\n\t\t},\n\t};\n\tif (snapshot !== \"latest\") {\n\t\t// @ts-ignore\n\t\tparams.delegations.__args.block = { number: snapshot };\n\t}\n\tconst result = await subgraphRequest(SNAPSHOT_SUBGRAPH_URL[network], params);\n\tif (!result || !result.delegations) return {};\n\n\tconst delegationsReverse = {};\n\tresult.delegations.forEach((delegation) => (delegationsReverse[delegation.delegator] = delegation.delegate));\n\tresult.delegations\n\t\t.filter((delegation) => delegation.space !== \"\")\n\t\t.forEach((delegation) => (delegationsReverse[delegation.delegator] = delegation.delegate));\n\n\treturn Object.fromEntries(\n\t\taddresses.map((address) => [\n\t\t\taddress,\n\t\t\tObject.entries(delegationsReverse)\n\t\t\t\t.filter(([, delegate]) => address.toLowerCase() === delegate)\n\t\t\t\t.map(([delegator]) => delegator),\n\t\t])\n\t);\n}\n","import { strategy as erc20BalanceOfStrategy } from \"../erc20-balance-of/index\";\nimport { getDelegations } from \"../../plugins\";\n\nexport const author = \"bonustrack\";\nexport const version = \"0.1.0\";\n\nexport async function strategy(space, network, provider, addresses, options, snapshot) {\n\tconst delegations = await getDelegations(space, network, provider, addresses, options, snapshot);\n\tif (Object.keys(delegations).length === 0) return {};\n\tconsole.debug(\"Delegations\", delegations);\n\n\tconst score = await erc20BalanceOfStrategy(\n\t\tspace,\n\t\tnetwork,\n\t\tprovider,\n\t\tObject.values(delegations).reduce((a, b) => a.concat(b)),\n\t\toptions,\n\t\tsnapshot\n\t);\n\tconsole.debug(\"Delegators score\", score);\n\n\treturn Object.fromEntries(\n\t\taddresses.map((address) => {\n\t\t\tconst addressScore = delegations[address] ? delegations[address].reduce((a, b) => a + score[b], 0) : 0;\n\t\t\treturn [address, addressScore];\n\t\t})\n\t);\n}\n","import { formatUnits } from \"@ethersproject/units\";\nimport { multicall, MULTICALL } from \"../../utils\";\nimport { abi } from \"../../../constants/abis/Multicall.json\";\n\nexport const author = \"bonustrack\";\nexport const version = \"0.1.0\";\n\nexport async function strategy(space, network, provider, addresses, options, snapshot) {\n\tconst blockTag = typeof snapshot === \"number\" ? snapshot : \"latest\";\n\tconst response = await multicall(\n\t\tnetwork,\n\t\tprovider,\n\t\tabi,\n\t\taddresses.map((address) => [MULTICALL[network], \"getEthBalance\", [address]]),\n\t\t{ blockTag }\n\t);\n\treturn Object.fromEntries(\n\t\tresponse.map((value, i) => [addresses[i], parseFloat(formatUnits(value.toString(), 18))])\n\t);\n}\n","import { formatUnits } from \"@ethersproject/units\";\nimport { multicall } from \"../../utils\";\n\nexport const author = \"bonustrack\";\nexport const version = \"0.1.0\";\n\nconst MAKER_DS_CHIEF_ADDRESS = {\n\t1: \"0x9ef05f7f6deb616fd37ac3c959a2ddd25a54e4f5\",\n};\n\nconst abi = [\n\t{\n\t\tconstant: true,\n\t\tinputs: [\n\t\t\t{\n\t\t\t\tname: \"\",\n\t\t\t\ttype: \"address\",\n\t\t\t},\n\t\t],\n\t\tname: \"deposits\",\n\t\toutputs: [\n\t\t\t{\n\t\t\t\tname: \"\",\n\t\t\t\ttype: \"uint256\",\n\t\t\t},\n\t\t],\n\t\tpayable: false,\n\t\tstateMutability: \"view\",\n\t\ttype: \"function\",\n\t},\n];\n\nexport async function strategy(space, network, provider, addresses, options, snapshot) {\n\tconst blockTag = typeof snapshot === \"number\" ? snapshot : \"latest\";\n\tconst response = await multicall(\n\t\tnetwork,\n\t\tprovider,\n\t\tabi,\n\t\taddresses.map((address) => [MAKER_DS_CHIEF_ADDRESS[network], \"deposits\", [address]]),\n\t\t{ blockTag }\n\t);\n\treturn Object.fromEntries(\n\t\tresponse.map((value, i) => [addresses[i], parseFloat(formatUnits(value.toString(), options.decimals))])\n\t);\n}\n","import { formatUnits } from \"@ethersproject/units\";\nimport { multicall } from \"../../utils\";\n\nexport const author = \"bonustrack\";\nexport const version = \"0.1.0\";\n\nconst UNI_ADDRESS = {\n\t1: \"0x1f9840a85d5af5bf1d1762f925bdaddc4201f984\",\n};\n\nconst abi = [\n\t{\n\t\tconstant: true,\n\t\tinputs: [\n\t\t\t{\n\t\t\t\tinternalType: \"address\",\n\t\t\t\tname: \"account\",\n\t\t\t\ttype: \"address\",\n\t\t\t},\n\t\t],\n\t\tname: \"getCurrentVotes\",\n\t\toutputs: [\n\t\t\t{\n\t\t\t\tinternalType: \"uint96\",\n\t\t\t\tname: \"\",\n\t\t\t\ttype: \"uint96\",\n\t\t\t},\n\t\t],\n\t\tpayable: false,\n\t\tstateMutability: \"view\",\n\t\ttype: \"function\",\n\t},\n];\n\nexport async function strategy(space, network, provider, addresses, options, snapshot) {\n\tconst blockTag = typeof snapshot === \"number\" ? snapshot : \"latest\";\n\tconst response = await multicall(\n\t\tnetwork,\n\t\tprovider,\n\t\tabi,\n\t\taddresses.map((address) => [UNI_ADDRESS[network], \"getCurrentVotes\", [address.toLowerCase()], { blockTag }])\n\t);\n\treturn Object.fromEntries(\n\t\tresponse.map((value, i) => [addresses[i], parseFloat(formatUnits(value.toString(), options.decimals))])\n\t);\n}\n","import { formatUnits } from \"@ethersproject/units\";\nimport { multicall } from \"../../utils\";\nimport { strategy as erc20BalanceOfStrategy } from \"../erc20-balance-of/index\";\n\nexport const author = \"bonustrack\";\nexport const version = \"0.1.0\";\n\nconst abi = [\n\t{\n\t\tconstant: true,\n\t\tinputs: [],\n\t\tname: \"getPricePerFullShare\",\n\t\toutputs: [\n\t\t\t{\n\t\t\t\tinternalType: \"uint256\",\n\t\t\t\tname: \"\",\n\t\t\t\ttype: \"uint256\",\n\t\t\t},\n\t\t],\n\t\tpayable: false,\n\t\tstateMutability: \"view\",\n\t\ttype: \"function\",\n\t},\n];\n\nexport async function strategy(space, network, provider, addresses, options, snapshot) {\n\tconst blockTag = typeof snapshot === \"number\" ? snapshot : \"latest\";\n\tlet [score, [pricePerFullShare]] = await Promise.all([\n\t\terc20BalanceOfStrategy(space, network, provider, addresses, options, snapshot),\n\t\tmulticall(network, provider, abi, [[options.address, \"getPricePerFullShare\", []]], { blockTag }),\n\t]);\n\tpricePerFullShare = parseFloat(formatUnits(pricePerFullShare.toString(), 18));\n\treturn Object.fromEntries(Object.entries(score).map((address) => [address[0], address[1] * pricePerFullShare]));\n}\n","import { formatUnits } from \"@ethersproject/units\";\nimport { multicall } from \"../../utils\";\n\nexport const author = \"adridadou\";\nexport const version = \"0.1.0\";\n\nconst abi = [\n\t{\n\t\tinputs: [\n\t\t\t{\n\t\t\t\tinternalType: \"address\",\n\t\t\t\tname: \"\",\n\t\t\t\ttype: \"address\",\n\t\t\t},\n\t\t],\n\t\tname: \"memberAddressByDelegateKey\",\n\t\toutputs: [\n\t\t\t{\n\t\t\t\tinternalType: \"address\",\n\t\t\t\tname: \"\",\n\t\t\t\ttype: \"address\",\n\t\t\t},\n\t\t],\n\t\tstateMutability: \"view\",\n\t\ttype: \"function\",\n\t},\n\t{\n\t\tinputs: [\n\t\t\t{\n\t\t\t\tinternalType: \"address\",\n\t\t\t\tname: \"\",\n\t\t\t\ttype: \"address\",\n\t\t\t},\n\t\t],\n\t\tname: \"members\",\n\t\toutputs: [\n\t\t\t{\n\t\t\t\tinternalType: \"address\",\n\t\t\t\tname: \"delegateKey\",\n\t\t\t\ttype: \"address\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tinternalType: \"uint256\",\n\t\t\t\tname: \"shares\",\n\t\t\t\ttype: \"uint256\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tinternalType: \"uint256\",\n\t\t\t\tname: \"loot\",\n\t\t\t\ttype: \"uint256\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tinternalType: \"bool\",\n\t\t\t\tname: \"exists\",\n\t\t\t\ttype: \"bool\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tinternalType: \"uint256\",\n\t\t\t\tname: \"highestIndexYesVote\",\n\t\t\t\ttype: \"uint256\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tinternalType: \"uint256\",\n\t\t\t\tname: \"jailed\",\n\t\t\t\ttype: \"uint256\",\n\t\t\t},\n\t\t],\n\t\tstateMutability: \"view\",\n\t\ttype: \"function\",\n\t},\n\t{\n\t\tinputs: [],\n\t\tname: \"totalShares\",\n\t\toutputs: [\n\t\t\t{\n\t\t\t\tinternalType: \"uint256\",\n\t\t\t\tname: \"\",\n\t\t\t\ttype: \"uint256\",\n\t\t\t},\n\t\t],\n\t\tstateMutability: \"view\",\n\t\ttype: \"function\",\n\t},\n];\n\nexport async function strategy(space, network, provider, addresses, options, snapshot) {\n\tconst blockTag = typeof snapshot === \"number\" ? snapshot : \"latest\";\n\tconst memberAddresses = await multicall(\n\t\tnetwork,\n\t\tprovider,\n\t\tabi,\n\t\taddresses.map((address) => [options.address, \"memberAddressByDelegateKey\", [address]]),\n\t\t{ blockTag }\n\t);\n\n\tconst response = await multicall(\n\t\tnetwork,\n\t\tprovider,\n\t\tabi,\n\t\tmemberAddresses\n\t\t\t.filter((addr) => addr.toString() !== \"0x0000000000000000000000000000000000000000\")\n\t\t\t.map((addr) => [options.address, \"members\", [addr.toString()]]),\n\t\t{ blockTag }\n\t);\n\n\treturn Object.fromEntries(\n\t\tresponse.map((value, i) => [addresses[i], parseFloat(formatUnits(value.shares.toString(), options.decimals))])\n\t);\n}\n","import { getAddress } from \"@ethersproject/address\";\nimport { subgraphRequest } from \"../../utils\";\n\nconst UNISWAP_SUBGRAPH_URL = {\n\t1: \"https://api.thegraph.com/subgraphs/name/uniswap/uniswap-v2\",\n};\n\nexport const author = \"vfatouros\";\nexport const version = \"0.1.0\";\n\nexport async function strategy(_space, network, provider, addresses, options, snapshot) {\n\tconst params = {\n\t\tusers: {\n\t\t\t__args: {\n\t\t\t\twhere: {\n\t\t\t\t\tid_in: addresses.map((address) => address.toLowerCase()),\n\t\t\t\t},\n\t\t\t\tfirst: 1000,\n\t\t\t},\n\t\t\tid: true,\n\t\t\tliquidityPositions: {\n\t\t\t\t__args: {\n\t\t\t\t\twhere: {\n\t\t\t\t\t\tliquidityTokenBalance_gt: 0,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tliquidityTokenBalance: true,\n\t\t\t\tpair: {\n\t\t\t\t\tid: true,\n\t\t\t\t\ttoken0: {\n\t\t\t\t\t\tid: true,\n\t\t\t\t\t},\n\t\t\t\t\treserve0: true,\n\t\t\t\t\ttoken1: {\n\t\t\t\t\t\tid: true,\n\t\t\t\t\t},\n\t\t\t\t\treserve1: true,\n\t\t\t\t\ttotalSupply: true,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t};\n\tif (snapshot !== \"latest\") {\n\t\t// @ts-ignore\n\t\tparams.users.liquidityPositions.__args.block = { number: snapshot };\n\t}\n\tconst tokenAddress = options.address.toLowerCase();\n\tconst result = await subgraphRequest(UNISWAP_SUBGRAPH_URL[network], params);\n\tconst score = {};\n\tif (result && result.users) {\n\t\tresult.users.forEach((u) => {\n\t\t\tu.liquidityPositions\n\t\t\t\t.filter((lp) => lp.pair.token0.id == tokenAddress || lp.pair.token1.id == tokenAddress)\n\t\t\t\t.forEach((lp) => {\n\t\t\t\t\tconst token0perUni = lp.pair.reserve0 / lp.pair.totalSupply;\n\t\t\t\t\tconst token1perUni = lp.pair.reserve1 / lp.pair.totalSupply;\n\t\t\t\t\tconst userScore =\n\t\t\t\t\t\tlp.pair.token0.id == tokenAddress\n\t\t\t\t\t\t\t? token0perUni * lp.liquidityTokenBalance\n\t\t\t\t\t\t\t: token1perUni * lp.liquidityTokenBalance;\n\n\t\t\t\t\tconst userAddress = getAddress(u.id);\n\t\t\t\t\tif (!score[userAddress]) score[userAddress] = 0;\n\t\t\t\t\tscore[userAddress] = score[userAddress] + userScore;\n\t\t\t\t});\n\t\t});\n\t}\n\treturn score || {};\n}\n","import { formatUnits } from \"@ethersproject/units\";\nimport { multicall } from \"../../utils\";\nimport { strategy as erc20BalanceOfStrategy } from \"../erc20-balance-of/index\";\n\nexport const author = \"pancake-swap\";\nexport const version = \"0.0.1\";\n\nconst sousChefabi = [\n\t{\n\t\tinputs: [\n\t\t\t{\n\t\t\t\tinternalType: \"address\",\n\t\t\t\tname: \"\",\n\t\t\t\ttype: \"address\",\n\t\t\t},\n\t\t],\n\t\tname: \"userInfo\",\n\t\toutputs: [\n\t\t\t{\n\t\t\t\tinternalType: \"uint256\",\n\t\t\t\tname: \"amount\",\n\t\t\t\ttype: \"uint256\",\n\t\t\t},\n\t\t],\n\t\tstateMutability: \"view\",\n\t\ttype: \"function\",\n\t},\n];\n\nconst masterChefAbi = [\n\t{\n\t\tinputs: [\n\t\t\t{\n\t\t\t\tinternalType: \"uint256\",\n\t\t\t\tname: \"\",\n\t\t\t\ttype: \"uint256\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tinternalType: \"address\",\n\t\t\t\tname: \"\",\n\t\t\t\ttype: \"address\",\n\t\t\t},\n\t\t],\n\t\tname: \"userInfo\",\n\t\toutputs: [\n\t\t\t{\n\t\t\t\tinternalType: \"uint256\",\n\t\t\t\tname: \"amount\",\n\t\t\t\ttype: \"uint256\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tinternalType: \"uint256\",\n\t\t\t\tname: \"rewardDebt\",\n\t\t\t\ttype: \"uint256\",\n\t\t\t},\n\t\t],\n\t\tstateMutability: \"view\",\n\t\ttype: \"function\",\n\t},\n];\n\nconst masterChefContractAddress = \"0x73feaa1eE314F8c655E354234017bE2193C9E24E\";\n\nexport async function strategy(space, network, provider, addresses, options, snapshot) {\n\tconst blockTag = typeof snapshot === \"number\" ? snapshot : \"latest\";\n\tconst score = await erc20BalanceOfStrategy(space, network, provider, addresses, options, snapshot);\n\n\tconst masterBalances = await multicall(\n\t\tnetwork,\n\t\tprovider,\n\t\tmasterChefAbi,\n\t\taddresses.map((address) => [masterChefContractAddress, \"userInfo\", [\"0\", address]]),\n\t\t{ blockTag }\n\t);\n\n\tconst sousBalances = await Promise.all(\n\t\toptions.chefAddresses.map((item) =>\n\t\t\tmulticall(\n\t\t\t\tnetwork,\n\t\t\t\tprovider,\n\t\t\t\tsousChefabi,\n\t\t\t\taddresses.map((address) => [item.address, \"userInfo\", [address], { blockTag }]),\n\t\t\t\t{ blockTag }\n\t\t\t)\n\t\t)\n\t);\n\n\treturn Object.fromEntries(\n\t\tObject.entries(score).map((address, index) => [\n\t\t\taddress[0],\n\t\t\taddress[1] +\n\t\t\t\tmasterBalances.reduce(\n\t\t\t\t\t(prev, cur, idx) => prev + parseFloat(formatUnits(cur.amount.toString(), 18)),\n\t\t\t\t\t0\n\t\t\t\t) +\n\t\t\t\tsousBalances.reduce(\n\t\t\t\t\t(prev, cur, idx) =>\n\t\t\t\t\t\tprev +\n\t\t\t\t\t\tparseFloat(formatUnits(cur[index].amount.toString(), options.chefAddresses[idx].decimals)),\n\t\t\t\t\t0\n\t\t\t\t),\n\t\t])\n\t);\n}\n","import { formatUnits } from \"@ethersproject/units\";\nimport { multicall } from \"../../utils\";\n\nexport const author = \"andytcf\";\nexport const version = \"0.0.1\";\n\nconst synthetixStateAbi = [\n\t{\n\t\tconstant: true,\n\t\tinputs: [{ name: \"\", type: \"address\" }],\n\t\tname: \"issuanceData\",\n\t\toutputs: [\n\t\t\t{ name: \"initialDebtOwnership\", type: \"uint256\" },\n\t\t\t{ name: \"debtEntryIndex\", type: \"uint256\" },\n\t\t],\n\t\tpayable: false,\n\t\tstateMutability: \"view\",\n\t\ttype: \"function\",\n\t},\n];\n\nconst synthetixStateContractAddress = \"0x4b9Ca5607f1fF8019c1C6A3c2f0CC8de622D5B82\";\n\nexport async function strategy(space, network, provider, addresses, _, snapshot) {\n\tconst blockTag = typeof snapshot === \"number\" ? snapshot : \"latest\";\n\tconst response = await multicall(\n\t\tnetwork,\n\t\tprovider,\n\t\tsynthetixStateAbi,\n\t\taddresses.map((address) => [synthetixStateContractAddress, \"issuanceData\", [address]]),\n\t\t{ blockTag }\n\t);\n\n\tconst quadraticWeighting = (value) => {\n\t\t// Scale the value by 100000\n\t\tconst scaledValue = value * 1e5;\n\t\treturn Math.sqrt(scaledValue);\n\t};\n\treturn Object.fromEntries(\n\t\tresponse.map((value, i) => {\n\t\t\treturn [\n\t\t\t\taddresses[i],\n\t\t\t\t// initialDebtOwnership returns in 27 decimal places\n\t\t\t\tquadraticWeighting(parseFloat(formatUnits(value.initialDebtOwnership.toString(), 27))),\n\t\t\t];\n\t\t})\n\t);\n}\n","import { formatUnits } from \"@ethersproject/units\";\nimport { multicall } from \"../../utils\";\n\nexport const author = \"arr00\";\nexport const version = \"0.1.0\";\n\nconst abi = [\n\t{\n\t\tconstant: true,\n\t\tinputs: [\n\t\t\t{\n\t\t\t\tinternalType: \"address\",\n\t\t\t\tname: \"account\",\n\t\t\t\ttype: \"address\",\n\t\t\t},\n\t\t],\n\t\tname: \"balanceOf\",\n\t\toutputs: [\n\t\t\t{\n\t\t\t\tinternalType: \"uint256\",\n\t\t\t\tname: \"\",\n\t\t\t\ttype: \"uint256\",\n\t\t\t},\n\t\t],\n\t\tpayable: false,\n\t\tstateMutability: \"view\",\n\t\ttype: \"function\",\n\t},\n\t{\n\t\tconstant: true,\n\t\tinputs: [\n\t\t\t{\n\t\t\t\tinternalType: \"address\",\n\t\t\t\tname: \"account\",\n\t\t\t\ttype: \"address\",\n\t\t\t},\n\t\t],\n\t\tname: \"borrowBalanceStored\",\n\t\toutputs: [\n\t\t\t{\n\t\t\t\tinternalType: \"uint256\",\n\t\t\t\tname: \"\",\n\t\t\t\ttype: \"uint256\",\n\t\t\t},\n\t\t],\n\t\tpayable: false,\n\t\tstateMutability: \"view\",\n\t\ttype: \"function\",\n\t},\n];\n\nexport async function strategy(space, network, provider, addresses, options, snapshot) {\n\tconst blockTag = typeof snapshot === \"number\" ? snapshot : \"latest\";\n\tconst oldBlockTag =\n\t\ttypeof snapshot === \"number\"\n\t\t\t? snapshot - options.offsetCheck\n\t\t\t: (await provider.getBlockNumber()) - options.offsetCheck;\n\n\tlet balanceOfCalls = addresses.map((address) => [options.address, \"balanceOf\", [address]]);\n\tlet borrowBalanceCalls = addresses.map((address) => [options.address, \"borrowBalanceStored\", [address]]);\n\tlet calls = balanceOfCalls.concat(borrowBalanceCalls);\n\n\tconst [response, balancesOldResponse] = await Promise.all([\n\t\tmulticall(network, provider, abi, calls, { blockTag }),\n\t\tmulticall(\n\t\t\tnetwork,\n\t\t\tprovider,\n\t\t\tabi,\n\t\t\taddresses.map((address) => [options.address, \"balanceOf\", [address]]),\n\t\t\t{ blockTag: oldBlockTag }\n\t\t),\n\t]);\n\n\tconst balancesNowResponse = response.slice(0, addresses.length);\n\tconst borrowsNowResponse = response.slice(addresses.length);\n\n\tlet resultData = {};\n\tfor (let i = 0; i < balancesNowResponse.length; i++) {\n\t\tlet noBorrow = 1;\n\t\tif (options.borrowingRestricted) {\n\t\t\tnoBorrow = borrowsNowResponse[i].toString().localeCompare(\"0\") == 0 ? 1 : 0;\n\t\t}\n\t\tconst balanceNow = parseFloat(formatUnits(balancesNowResponse[i].toString(), options.decimals));\n\t\tconst balanceOld = parseFloat(formatUnits(balancesOldResponse[i].toString(), options.decimals));\n\t\tresultData[addresses[i]] = Math.min(balanceNow, balanceOld) * noBorrow;\n\t}\n\treturn resultData;\n}\n","import { formatUnits } from \"@ethersproject/units\";\nimport { getAddress } from \"@ethersproject/address\";\nimport { subgraphRequest, multicall } from \"../../utils\";\n\nexport const author = \"bun919tw\";\nexport const version = \"0.1.0\";\n\nconst CREAM_SWAP_SUBGRAPH_URL = {\n\t1: \"https://api.thegraph.com/subgraphs/name/creamfinancedev/cream-swap-v2\",\n\t3: \"https://api.thegraph.com/subgraphs/name/creamfinancedev/cream-swap-dev\",\n};\n\nconst longTermPoolABI = [\n\t{\n\t\tconstant: true,\n\t\tinputs: [\n\t\t\t{\n\t\t\t\tinternalType: \"address\",\n\t\t\t\tname: \"account\",\n\t\t\t\ttype: \"address\",\n\t\t\t},\n\t\t],\n\t\tname: \"balanceOf\",\n\t\toutputs: [\n\t\t\t{\n\t\t\t\tinternalType: \"uint256\",\n\t\t\t\tname: \"\",\n\t\t\t\ttype: \"uint256\",\n\t\t\t},\n\t\t],\n\t\tpayable: false,\n\t\tstateMutability: \"view\",\n\t\ttype: \"function\",\n\t},\n];\n\nexport async function strategy(space, network, provider, addresses, options, snapshot) {\n\tconst creamAddress = options.address;\n\tlet [score, creamBalance] = await Promise.all([\n\t\tcreamSwapScore(network, addresses, creamAddress, snapshot),\n\t\tcreamBalanceOf(network, provider, addresses, options, snapshot),\n\t]);\n\tfor (const [userAddress, userBalance] of Object.entries(creamBalance)) {\n\t\tif (!score[userAddress]) score[userAddress] = 0;\n\t\tscore[userAddress] = score[userAddress] + userBalance;\n\t}\n\n\treturn score || {};\n}\n\nasync function creamSwapScore(network, addresses, creamAddress, snapshot) {\n\tconst params = {\n\t\tpoolShares: {\n\t\t\t__args: {\n\t\t\t\twhere: {\n\t\t\t\t\tuserAddress_in: addresses.map((address) => address.toLowerCase()),\n\t\t\t\t\tbalance_gt: 0,\n\t\t\t\t},\n\t\t\t\tfirst: 1000,\n\t\t\t\torderBy: \"balance\",\n\t\t\t\torderDirection: \"desc\",\n\t\t\t},\n\t\t\tuserAddress: {\n\t\t\t\tid: true,\n\t\t\t},\n\t\t\tbalance: true,\n\t\t\tpoolId: {\n\t\t\t\ttotalShares: true,\n\t\t\t\ttokens: {\n\t\t\t\t\tid: true,\n\t\t\t\t\tbalance: true,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t};\n\tif (snapshot !== \"latest\") {\n\t\t// @ts-ignore\n\t\tparams.poolShares.__args.block = { number: snapshot };\n\t}\n\tconst result = await subgraphRequest(CREAM_SWAP_SUBGRAPH_URL[network], params);\n\tconst score = {};\n\tif (result && result.poolShares) {\n\t\tresult.poolShares.forEach((poolShare) =>\n\t\t\tpoolShare.poolId.tokens.map((poolToken) => {\n\t\t\t\tconst [, tokenAddress] = poolToken.id.split(\"-\");\n\t\t\t\tif (typeof creamAddress === \"string\" && tokenAddress === creamAddress.toLowerCase()) {\n\t\t\t\t\tconst userAddress = getAddress(poolShare.userAddress.id);\n\t\t\t\t\tif (!score[userAddress]) score[userAddress] = 0;\n\t\t\t\t\tscore[userAddress] =\n\t\t\t\t\t\tscore[userAddress] + (poolToken.balance / poolShare.poolId.totalShares) * poolShare.balance;\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t}\n\treturn score || {};\n}\n\nasync function creamBalanceOf(network, provider, addresses, options, snapshot) {\n\tconst blockTag = typeof snapshot === \"number\" ? snapshot : \"latest\";\n\tconst numPool = options.pools.length;\n\tconst numAddress = addresses.length;\n\n\tconst calls = [];\n\tfor (let i = 0; i < numPool; i++) {\n\t\tcalls.push(...addresses.map((address) => [options.pools[i].address, \"balanceOf\", [address]]));\n\t}\n\n\tconst balances = await multicall(network, provider, longTermPoolABI, calls, {\n\t\tblockTag,\n\t});\n\n\treturn Object.fromEntries(\n\t\taddresses.map((address, i) => {\n\t\t\tlet sum = 0;\n\t\t\tfor (let j = 0; j < numPool; j++) {\n\t\t\t\tsum += parseFloat(formatUnits(balances[i + j * numAddress].toString(), 18));\n\t\t\t}\n\t\t\treturn [address, sum];\n\t\t})\n\t);\n}\n","import { formatUnits } from \"@ethersproject/units\";\nimport { multicall } from \"../../utils\";\n\nexport const author = \"l3wi\";\nexport const version = \"0.1.0\";\n\nconst abi = [\n\t{\n\t\tconstant: true,\n\t\tinputs: [{ internalType: \"address\", name: \"account\", type: \"address\" }],\n\t\tname: \"balanceOfBonded\",\n\t\toutputs: [{ internalType: \"uint256\", name: \"\", type: \"uint256\" }],\n\t\tpayable: false,\n\t\tstateMutability: \"view\",\n\t\ttype: \"function\",\n\t},\n\t{\n\t\tconstant: true,\n\t\tinputs: [{ internalType: \"address\", name: \"\", type: \"address\" }],\n\t\tname: \"balanceOf\",\n\t\toutputs: [{ internalType: \"uint256\", name: \"\", type: \"uint256\" }],\n\t\tpayable: false,\n\t\tstateMutability: \"view\",\n\t\ttype: \"function\",\n\t},\n\t{\n\t\tconstant: true,\n\t\tinputs: [],\n\t\tname: \"totalSupply\",\n\t\toutputs: [{ internalType: \"uint256\", name: \"\", type: \"uint256\" }],\n\t\tpayable: false,\n\t\tstateMutability: \"view\",\n\t\ttype: \"function\",\n\t},\n];\n\nexport async function strategy(space, network, provider, addresses, options, snapshot) {\n\tconst blockTag = typeof snapshot === \"number\" ? snapshot : \"latest\";\n\n\tconst daoQuery = addresses.map((address) => [options.dao, \"balanceOfBonded\", [address]]);\n\n\tconst lpQuery = addresses.map((address) => [options.rewards, \"balanceOfBonded\", [address]]);\n\n\tconst response = await multicall(\n\t\tnetwork,\n\t\tprovider,\n\t\tabi,\n\t\t[[options.token, \"balanceOf\", [options.uniswap]], [options.uniswap, \"totalSupply\"], ...daoQuery, ...lpQuery],\n\t\t{ blockTag }\n\t);\n\n\tconst uniswapESD = response[0];\n\tconst uniswapTotalSupply = response[1];\n\tconst daoBalances = response.slice(2, addresses.length + 2);\n\tconst lpBalances = response.slice(addresses.length + 2, addresses.length * 2 + 2);\n\n\treturn Object.fromEntries(\n\t\tArray(addresses.length)\n\t\t\t.fill(\"x\")\n\t\t\t.map((_, i) => [\n\t\t\t\taddresses[i],\n\t\t\t\tparseFloat(\n\t\t\t\t\tformatUnits(\n\t\t\t\t\t\tuniswapESD[0]\n\t\t\t\t\t\t\t.div(uniswapTotalSupply[0])\n\t\t\t\t\t\t\t.mul(lpBalances[i][0])\n\t\t\t\t\t\t\t.add(daoBalances[i][0])\n\t\t\t\t\t\t\t.toString(),\n\t\t\t\t\t\toptions.decimals\n\t\t\t\t\t)\n\t\t\t\t),\n\t\t\t])\n\t);\n}\n","import { multicall } from \"../../utils\";\n\nexport const author = \"vfatouros\";\nexport const version = \"0.1.0\";\n\nconst tokenAbi = [\n\t{\n\t\tconstant: true,\n\t\tinputs: [\n\t\t\t{\n\t\t\t\tinternalType: \"address\",\n\t\t\t\tname: \"account\",\n\t\t\t\ttype: \"address\",\n\t\t\t},\n\t\t],\n\t\tname: \"balanceOf\",\n\t\toutputs: [\n\t\t\t{\n\t\t\t\tinternalType: \"uint256\",\n\t\t\t\tname: \"\",\n\t\t\t\ttype: \"uint256\",\n\t\t\t},\n\t\t],\n\t\tpayable: false,\n\t\tstateMutability: \"view\",\n\t\ttype: \"function\",\n\t},\n\t{\n\t\tconstant: true,\n\t\tinputs: [],\n\t\tname: \"totalSupply\",\n\t\toutputs: [\n\t\t\t{\n\t\t\t\tinternalType: \"uint256\",\n\t\t\t\tname: \"\",\n\t\t\t\ttype: \"uint256\",\n\t\t\t},\n\t\t],\n\t\tpayable: false,\n\t\tstateMutability: \"view\",\n\t\ttype: \"function\",\n\t},\n];\n\nexport async function strategy(_space, network, provider, addresses, options, snapshot) {\n\tconst blockTag = typeof snapshot === \"number\" ? snapshot : \"latest\";\n\tconst res = await multicall(\n\t\tnetwork,\n\t\tprovider,\n\t\ttokenAbi,\n\t\t[\n\t\t\t[options.uniswapAddress, \"totalSupply\", []],\n\t\t\t[options.tokenAddress, \"balanceOf\", [options.uniswapAddress]],\n\t\t].concat(addresses.map((address) => [options.stakingAddress, \"balanceOf\", [address]])),\n\t\t{ blockTag }\n\t);\n\n\tconst totalSupply = res[0];\n\tconst tokenBalanceInUni = res[1];\n\tconst tokensPerUni = tokenBalanceInUni / 10 ** options.decimals / (totalSupply / 1e18);\n\n\tconst response = res.slice(2);\n\n\treturn Object.fromEntries(\n\t\tresponse.map((value, i) => [addresses[i], (value / 10 ** options.decimals) * tokensPerUni])\n\t);\n}\n","import { strategy as balancer } from \"./balancer/index\";\nimport { strategy as contractCall } from \"./contract-call/index\";\nimport { strategy as erc20BalanceOf } from \"./erc20-balance-of/index\";\nimport { strategy as erc20BalanceOfCoeff } from \"./erc20-balance-of-coeff/index\";\nimport { strategy as erc20BalanceOfFixedTotal } from \"./erc20-balance-of-fixed-total/index\";\nimport { strategy as erc20BalanceOfCv } from \"./erc20-balance-of-cv/index\";\nimport { strategy as erc20WithBalance } from \"./erc20-with-balance/index\";\nimport { strategy as erc20BalanceOfDelegation } from \"./erc20-balance-of-delegation/index\";\nimport { strategy as ethBalance } from \"./eth-balance/index\";\nimport { strategy as makerDsChief } from \"./maker-ds-chief/index\";\nimport { strategy as uni } from \"./uni/index\";\nimport { strategy as yearnVault } from \"./yearn-vault/index\";\nimport { strategy as moloch } from \"./moloch/index\";\nimport { strategy as uniswap } from \"./uniswap/index\";\nimport { strategy as pancake } from \"./pancake/index\";\nimport { strategy as synthetix } from \"./synthetix/index\";\nimport { strategy as ctoken } from \"./ctoken/index\";\nimport { strategy as cream } from \"./cream/index\";\nimport { strategy as esd } from \"./esd/index\";\nimport { strategy as stakedUniswap } from \"./staked-uniswap/index\";\n\nexport default {\n\tbalancer,\n\t\"contract-call\": contractCall,\n\t\"erc20-balance-of\": erc20BalanceOf,\n\t\"erc20-balance-of-fixed-total\": erc20BalanceOfFixedTotal,\n\t\"erc20-balance-of-cv\": erc20BalanceOfCv,\n\t\"erc20-balance-of-coeff\": erc20BalanceOfCoeff,\n\t\"erc20-with-balance\": erc20WithBalance,\n\t\"erc20-balance-of-delegation\": erc20BalanceOfDelegation,\n\t\"eth-balance\": ethBalance,\n\t\"maker-ds-chief\": makerDsChief,\n\tuni,\n\t\"yearn-vault\": yearnVault,\n\tmoloch,\n\tuniswap,\n\tpancake,\n\tsynthetix,\n\tctoken,\n\tcream,\n\t\"staked-uniswap\": stakedUniswap,\n\tesd,\n};\n","import { Interface } from \"@ethersproject/abi\";\nimport { Contract } from \"@ethersproject/contracts\";\nimport numeral from \"numeral\";\nimport { jsonToGraphQLQuery } from \"json-to-graphql-query\";\nimport { abi as multicallAbi } from \"../constants/abis/Multicall.json\";\nimport _strategies from \"./strategies\";\nimport { getContract } from \"../utils\";\n\nexport const MULTICALL = {\n\t1: \"0xeefba1e63905ef1d7acba5a8513c70307c1ce441\",\n\t4: \"0x42ad527de7d4e9d9d011ac45b31d8551f8fe9821\",\n\t5: \"0x77dca2c955b15e9de4dbbcf1246b4b85b651e50e\",\n\t6: \"0x53c43764255c17bd724f74c4ef150724ac50a3ed\",\n\t42: \"0x2cc8688c5f75e365aaeeb4ea8d6a480405a48d2a\",\n\t56: \"0x1ee38d535d541c55c9dae27b12edf090c608e6fb\",\n\t82: \"0x579De77CAEd0614e3b158cb738fcD5131B9719Ae\",\n\t97: \"0x8b54247c6BAe96A6ccAFa468ebae96c4D7445e46\",\n\t100: \"0xb5b692a88bdfc81ca69dcb1d924f59f0413a602a\",\n\twanchain: \"0xba5934ab3056fca1fa458d30fbb3810c3eb5145f\",\n};\n\nexport const SNAPSHOT_SUBGRAPH_URL = {\n\t1: \"https://api.thegraph.com/subgraphs/name/snapshot-labs/snapshot\",\n\t4: \"https://api.thegraph.com/subgraphs/name/snapshot-labs/snapshot-rinkeby\",\n\t42: \"https://api.thegraph.com/subgraphs/name/snapshot-labs/snapshot-kovan\",\n};\n\nexport async function call(provider, abi, call, options) {\n\tconst contract = new Contract(call[0], abi, provider);\n\ttry {\n\t\tconst params = call[2] || [];\n\t\treturn await contract[call[1]](...params, options || {});\n\t} catch (e) {\n\t\treturn Promise.reject(e);\n\t}\n}\n\nexport async function multicall(network, provider, abi, calls, options) {\n\tconst itf = new Interface(abi);\n\tconst multi = getContract(MULTICALL[network], multicallAbi, provider);\n\ttry {\n\t\ttry {\n\t\t\tconst [, res] = await multi.aggregate(\n\t\t\t\tcalls.map((call) => [call[0].toLowerCase(), itf.encodeFunctionData(call[1], call[2])]),\n\t\t\t\toptions || {}\n\t\t\t);\n\t\t\treturn res.map((call, i) => itf.decodeFunctionResult(calls[i][1], call));\n\t\t} catch (e) {\n\t\t\treturn [];\n\t\t}\n\t} catch (e) {\n\t\treturn Promise.reject(e);\n\t}\n}\n\nexport async function subgraphRequest(url, query) {\n\tconst res = await fetch(url, {\n\t\tmethod: \"POST\",\n\t\theaders: {\n\t\t\tAccept: \"application/json\",\n\t\t\t\"Content-Type\": \"application/json\",\n\t\t},\n\t\tbody: JSON.stringify({ query: jsonToGraphQLQuery({ query }) }),\n\t});\n\tconst { data } = await res.json();\n\treturn data || {};\n}\n\nexport async function ipfsGet(gateway, ipfsHash, protocolType = \"ipfs\") {\n\tconst url = `https://${gateway}/${protocolType}/${ipfsHash}`;\n\treturn fetch(url).then((res) => res.json());\n}\n\nexport async function getScores(space, strategies, network, provider, addresses, snapshot = \"latest\") {\n\treturn await Promise.all(\n\t\tstrategies.map((strategy) =>\n\t\t\t_strategies[strategy.name](space, network, provider, addresses, strategy.params, snapshot)\n\t\t)\n\t);\n}\n\nexport function jsonParse(input, fallback) {\n\tif (typeof input !== \"string\") {\n\t\treturn fallback || {};\n\t}\n\ttry {\n\t\treturn JSON.parse(input);\n\t} catch (err) {\n\t\treturn fallback || {};\n\t}\n}\n\nexport function _numeral(number, format = \"(0.[00]a)\") {\n\treturn numeral(number).format(format);\n}\n\nexport function formatProposal(base) {\n\tconst proposal = JSON.parse(JSON.stringify(base));\n\tproposal.msg = jsonParse(proposal.msg, proposal.msg);\n\n\t// v0.1.0\n\tif (proposal.msg.version === \"0.1.0\") {\n\t\tproposal.msg.payload.start = 1595088000;\n\t\tproposal.msg.payload.end = 1595174400;\n\t\tproposal.msg.payload.snapshot = 10484400;\n\t\tproposal.bpt_voting_disabled = \"1\";\n\t}\n\n\t// v0.1.1\n\tif (proposal.msg.version === \"0.1.0\" || proposal.msg.version === \"0.1.1\") {\n\t\tproposal.msg.payload.metadata = {};\n\t}\n\n\treturn proposal;\n}\n\nexport function formatProposals(proposals) {\n\treturn Object.fromEntries(Object.entries(proposals).map((proposal) => [proposal[0], formatProposal(proposal[1])]));\n}\n\nexport default {\n\tcall,\n\tmulticall,\n\tsubgraphRequest,\n\tipfsGet,\n\tgetScores,\n};\n"],"sourceRoot":""}